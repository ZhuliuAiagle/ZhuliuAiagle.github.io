---
layout: post
title:  "Vim学习笔记（持续更新中）"
date:   2019-10-08 11:05:00 +0700
categories: zijin update
---
实习这段时间经常要在server侧编辑配置文件和代码文件，还需要在软件或者系统日志中进行快速定位。在这个过程中，我逐渐意识到了Nano编辑器的局限性。在mentor的建议和自身需求的驱动下，我决定开始学习vim的相关操作。主要学习工具是Linux下的Vimtutor。

考虑到Vimtutor虽然结合实操学起来比较快，但有些操作毕竟还是需要记忆的。因此准备把知识点整理在这里，以便日后查阅。

### 移动光标

在普通模式下可以使用`J`,`K`向上和向下移动，使用`H`,`L`向左和向右移动。记忆方法：H在最左边而L在最右边，J是“Jump”的简写，有“跳过”之义。

使用方向键也是可以的，但tutor更推荐使用`HJKL`作为标准移动键位。

此外，在普通模式下使用回车键`<ENTER>`也可以换行。

### 退出vim

* `:q!`：不保存所有修改，直接退出vim；
* `:wq`：保存修改后退出vim，在readonly模式下可能会失败。

### X：删除单个字符

在普通模式下，将光标置于想删除的字符下面，按动`X`键，就可以删除光标指向的字符。删除后，光标停留在右边的字符上。

在INSERT模式下使用`BACKSPACE`退格键也可以使用常规方法删除字符，不过前提是在输入字符之后没有使用方向键移动光标，否则字符就会固定，无法使用退格键删除。

### I：插入文字

在普通模式下按动`I`键可以进入INSERT模式。INSERT模式可以在光标停留字符的**前面**插入字符，感受和所见即所得编辑大体相同。INSERT模式下不能使用`ENTER`等会添加字符的移动方式进行行间移动，普通模式下的命令也将不可用。



若想退回普通模式，按动`ESC`键即可。

### A：在行末插入文字

在普通模式下按动`A`键同样可以进入INSERT模式，但光标会自动移动到下一个字母上（如果是行尾，会移动到最后一个字符后），也就是说，从之前光标在的位置的**后面**插入字符。


### DW: 删除一个单词

使用组合键`DW`可以删除一个单词。删除后，光标会停在下一个单词的第一个字母上（而不是空格上）。如果单词在行末，光标会停在行末字母上。

删除必须把光标放在单词第一个字符上，如果不是，只删去从光标开始到单词结束的字符。

单词的判断依据非26个字母的字符进行分割。如删除`sentence.`这个单词，句号不会删除；删除`don't`这个单词，只会删除`don`的部分，斜撇和最后一个字母并不会删除。

原文表述：until the start of the next word, EXCLUDING its first character.

### 其他D\<MOTION>系列命令

* `D$`：删除从光标开始到行末的所有字符；
* `DE`：同样是删掉一个单词，只到这个单词的最后，但保留上一个单词前的空格。原文表述：to the end of the current word, INCLUDING the last character.

### 单纯的\<MOTION>系列命令

不加D，单纯的按动`<MOITION>`对应的键，会将光标放置到删除对应字段后原本该停放的位置（但不会在删除对应字段）。
* `E`会将光标放到**单词末尾处**；
* `W`会将光标放到**下一个单词首位**；
* `$`会将光标放到**行末**。

### 数字+\<MOTION>系列命令

* `nW`（n为数字）会将光标向前移动N个单词的距离，停在第N个单词的开头；
* `nE`（n为数字）会将光标移动到包含当前所在单词的第N个单词的末尾（如果光标在单词最末尾，则移动到下一个单词）；
* 输入`0`会将光标移动到一行的开头。


### D+数字+\<MOTION>命令

可以按照`<MOTION>`的规则删除多个单词，适用于`D`, `W`。移动规则同`DW`与`DE`。

### 数字+DD命令

`DD`可以删除单行。`nDD`（n为数字）可以删除多行。

### U系列命令（大写与小写）

* 小写`u`可以撤回之前进行的一个操作；
* 大写`U`可以撤回一行之内的所有**更改**（并不是操作本身）；
* u可以用来撤回U操作；
* `CTRL+R`可以用来重做（REDO）被撤销的操作，即撤回u操作。


### P命令：粘贴删除的文本与行

`P`命令可以将之前删除掉的文本粘贴在光标之后。

如果删除的是一段字符，他会粘在光标之后；

如果删除的是用`DD`删除的一整行，他会粘在光标所在那一行的下面（这里的一整行是指用`DD`删除，用其他命令删除均属“一段字符”的范畴）

### R+<字符>命令：替换单个字符

`R`命令后加要替换的字符可以将光标所在位置的字符替换为指定字符。支持shift。

### CE命令：修改整个单词

`CE`命令将会把当前光标之后的单词主体删除，保留所有空格，同时编辑器进入INSERT模式。修改完单词后，需手动退出该模式。

### Cn\<MOTION>命令

n相当于重复操作的次数或者是偏移量，`<MOTION>`可以是e，也可以是w，也可以是$

### 关于e和w的理解

一个e相当于“到下一个单词的终点”，不是说，“下一个单词”的“终点”，而是“下一个”“单词的终点”。也就是说，他从当前位置跳到下一个符合“单词终点”这一要求的地方；而w则是“下一个起点”。与之相关的命令都可以类似理解。如dw就是“删到下一个开头处但不包括开头”，de就是“删到下一个结尾且包括结尾”，光标移动到第一个“不被包括”的字符上；ce是删到下一个结束处结束，而cw是删到开头处结束（如果从最后一个单词字符开始，ce会一直删到下一个结束处（包括这个结束处），cw则会只删除当前字符（即删到非单词字符前），如果从非单词字符开始，cw会一直删到下一个开头，而ce会一直删到下一个结尾……）。加上数字就相当于对应的命令执行了多次。

感觉这块很迷，感觉要多练才行……

### 使用G组合键在文档中移动位置

* `<CTRL-G>`显示当前光标所在的行的位置以及占全部内容的百分比；
* `G`去往文件最末尾；
* `gg`去往文件开头；
* `行数+G`（大G）去往文件指定行。

### 查询命令

* 按住`/`进入搜索模式，输入要搜索的词就可以进行搜索；
* 重复再向相同搜索一次，按`n`；
* 重复向反方向再搜索一次，按`N`；
* 使用`?`从后往前搜；
* `CTRL-O`后退上一个光标位置，`CTRL-I`前进下一个光标位置。
* 当搜索到达文件末尾时，它将继续从头开始，除非已重置“ wrapscan”选项。

### 使用%匹配大中小括号

* 使用%匹配一行或多行内一个括号的另一个匹配括号（大中小），光标放在对应括号上

### 替换命令

* `s/old/new`：将一行第一个匹配的换成新的；
* `s/old/new/g`：将一行里所有匹配的换成新的；
* `#,#s/old/new/g`：指定要参与替换的行数范围，然后替换一行中所有；
* `%s/old/new/g`：替换文件中所有；
* `%s/old/new/gc`：查找整个文件中的所有匹配项，并提示是否替换。

### 执行外部shell命令

在普通模式按下`:!`组合键再加上`<shell命令>`就可以执行外部shell命令，有回显的结果会显示在外部shell上，然后再回车可以返回vim界面。

### 保存当前文件到目录

`:w filename.*`可将文件保存至当前目录；`:w <现有路径>/filename.*`可将文件保存至现有某一目录下。

### 保存文件的一部分到目录

按`v`键可以进入visual模式，visual模式下从光标开始处移动光标，可以对文本进行选中，选中后按下`:w filename.*`可以将这部分被选中的内容保存到指定路径下。

### 合并文件（复制粘贴）

将光标放到想粘贴的位置，然后执行`:r TEST`命令，就可以将TEST文件中的内容粘贴到指定位置（retrieve）；
`:r`可以搭配一些命令使用，如`:r !ls`可以将`!ls`的结果粘贴到文件中。




